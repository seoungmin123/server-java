### ** ✅ 체크리스트**
<!-- 
스스로 만족스러운 과제를 제출했는지 확인하기 위해 체크하는 항목들입니다. 최소한 다음의 기준을 만족시키지 못한다면, 좋은 피드백을 받을 수 없습니다.
-->
- [] 요구사항을 구체화하고 분석하여 작업 가능한 단위로 정리하였는가?
- [] 비즈니스 요구사항을 충족하는 ERD가 작성되었는가?
- [] 핵심 기능에 대한 시퀀스 다이어그램이 작성되었는가?
- [] REST 규칙에 따라서 API를 문서화하였는가?
- [] 더미데이터를 제공하는 Mock API를 작성하였는가?

---
### ** 🧠 STEP03  분석 사고 흐름 **
- 시나리오 기반으로 기능 요구사항 흐름을 먼저 정리하여 개요를 파악한 뒤, 주요 기능은 시퀀스 다이어그램으로 호출 관계를 표현했습니다.
    - **쿠폰 기능**은 단일 동작이므로 계층 구조 시퀀스 다이어그램으로 작성하였습니다.
    - **주문 기능**은 여러 도메인이 엮이므로 도메인 간 관계 중심 시퀀스 다이어그램으로 작성하였습니다.

- **ERD 설계**시 현재는 환불/취소 기능이 없기 때문에 `orders`와 `order_payments`는 `1:1` 관계로 설정했습니다. 추후 확장을 고려하면 1:N도 가능하지만 현재 요구사항엔 1:1이 적절하다고 판단했습니다.

- **선착순쿠폰 발급** 관련 `coupon_policy 테이블`에 이미 쿠폰명이 있지만 `coupons 테이블`에서도 발급 후 조회나 쿠폰 정책이 변경되어 쿠폰명이 바뀌더라도 발급 당시의 쿠폰명을 기록하기위해 추가했습니다.

- **인기상품 조회 기능**은 `order_items 테이블`에서 집계하는 구조이므로, `status`, `ordered_at` 컬럼을 `order_items 테이블`에도 추가했습니다. 단, 이 경우 `orders 테이블`의 상태 변경 시 `order_items 테이블`도 동기화가 필요하다는 점을 주의해야 합니다.

- **비기능 요구사항**은 정성적 항목이 많아 현재는 키워드 중심으로 정리해두었습니다.

- 주문 후 **외부 시스템 주문 연동 처리**시 이력 테이블 없이 mock 전송 로직만 포함하였습니다.
---

### ** 💬 리뷰 포인트(질문)**

### 1. `order_items` 상태 컬럼 및 구조 확장성 관련
- ERD에서 `order_items`에 개별 `status` 값을 둔 이유는, 인기상품 조회 시의 성능 최적화와 **부분 취소/부분 환불 기능 확장**을 고려한 설계입니다.
- 현재는 `orders`와 `order_items`가 1:1 관계지만 1:N으로 확장될 경우,
- 단순히 관계만 변경하면 되는지 아니면 마지막 처리 여부를 나타내는 `is_last`와 같은 별도 컬럼을 추가로 두는 게 정합성 유지나 쿼리 효율 측면에서 더 나은지 질문드립니다.

### 2. 쿠폰 정책/발급 테이블 분리 및 제약 설정 관련
- 쿠폰은 정책 정보(`coupon_policy`)와 실제 발급된 쿠폰(`coupon`)을 나눠서 관리하며,
- 사용자별로 같은 정책의 쿠폰은 한 번만 발급 가능하도록 `CONSTRAINT uq_user_policy UNIQUE (user_id, coupon_policy_id)` 제약을 걸었습니다.
- DB 제약과 서비스 로직을 이중으로 두는 방식이 불필요한 중복으로 보일 수 있는지 아니면 좀 안전한 설계 구조인지 질문드립니다.


### 3. 시퀀스 다이어그램 내 트랜잭션/락 처리 표현 방식
- 시퀀스 다이어그램 안에 트랜잭션 범위랑 락 처리 흐름도 같이 표현했습니다.
- 이런 방식이 설계 의도를 전달하기에 괜찮은지 아니면 더 나은 표현 방법이 있을지 질문드립니다.

### 4. 외부 시스템 주문연동 시 에러처리
- 주문 후 외부시스템 api 호출시 이력을 남기는 테이블은 설계/생성을 하지않았습니다.
- 시스템이 호출시 비동기처리나 재시도를 해야할 경우도 생겨서 이력테이블이 필수일것같긴한데 현재는 mock 전송 로직만 포함해도 될지 질문드립니다.

---

### ** 📝 이번주 KPT 회고**

### ✅ Keep
<!-- 유지해야 할 좋은 점 -->
기능/도메인 구조에 대해 충분히 고민하고 정리한 후 시퀀스를 작성함으로써 요구사항 분석을 체계적으로 수행할 수 있었습니다.

### ❗ Problem
<!--개선이 필요한 점-->
ERD/시퀀스 작성 이후에 Mock API를 작성하려니 명세 간 미묘한 불일치가 발견되어 수정 시간이 소요되었습니다.

### 💡 Try
<!-- 새롭게 시도할 점 -->
동시성 처리 및 분산 시스템 설계까지 고려 할 예정입니다.

